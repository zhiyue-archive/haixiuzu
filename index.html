<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <title>豆瓣-请不要害羞组</title>
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <meta name="description" content="豆瓣 - 请不要害羞 - 豆瓣最大的美女图片分享平台，镜头绘制的美好瞬间。">
    <meta name="author" content="Binux">
    <script>
      var duoshuoQuery = {
        short_name: 'dbhaiziu'
      };
    </script>
    <link rel="stylesheet" href="http://cdnjscn.b0.upaiyun.com/libs/twitter-bootstrap/3.2.0/css/bootstrap.min.css">
    <style>
      .thumbnail {
        width: 330px; 
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175); 
      }
      .thumbnail .caption h3 {
        font-size: 18px;
      }
      #progress {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        background-color: #ddd;
        z-index: -1;
        transition: height 0.3s;
      }
    </style>
  </head>

  <body>
    <h1>豆瓣 - <a href="http://www.douban.com/group/haixiuzu/" target="_blank" rel="nofollow noreferrer">请不要害羞</a></h1>
    <p>豆瓣最大的美女图片分享平台，镜头绘制的美好瞬间。 </p>
    <div id="progress"></div>
    <div id="posts">
    </div>
    <script id="post-tpl" type="x-tmpl-mustache">
      {{#.}}
        <div class="thumbnail post">
          {{#imgs}}
            <img src="{{.}}" alt="{{ title }}" rel="nofollow noreferer">
          {{/imgs}}
          <div class="caption">
            <h3><a href="{{ url }}" target="_blank">{{ title }}</a></h3>
            <p>by <a href="{{ author_url }}" target="_blank" rel="nofollow noreferer">{{ author }}</a></p>
            <p>{{ time }}</p>
          </div>
        </div>
      {{/.}}
    </script>
    <script src="http://cdnjscn.b0.upaiyun.com/libs/mustache.js/0.8.1/mustache.min.js"></script>
    <script src="http://cdnjscn.b0.upaiyun.com/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="http://cdnjscn.b0.upaiyun.com/libs/twitter-bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="http://cdnjscn.b0.upaiyun.com/libs/masonry/3.1.5/masonry.pkgd.min.js"></script>
    <script src="http://cdnjscn.b0.upaiyun.com/libs/jquery.imagesloaded/3.0.4/jquery.imagesloaded.min.js"></script>
    <script src="http://static.duoshuo.com/embed.unstable.js"></script>
    <script>
      var container = $("#posts").masonry({
        columnWidth: 20
      });
      var CUR_PAGE = 1;
      var isloading = false;
      var offset_pos;

      function load(page) {
        isloading = true;
        DUOSHUO.API.get("threads/listPosts", {
          thread_key: "doubanhaixiuzu",
          page: page,
          limit: 10
        }, function(data) {
          console.log(data);
          var parsed_data = [];
          $.each(data.response, function(i, e) {
            e = data.parentPosts[e];
            var msg = null;
            try {
              msg = JSON.parse(atob(e.message.replace(/<br\/>/g, '')));
            } catch (error) {
              try {
                msg = JSON.parse(e.message);
              } catch (error) {
                try {
                  var msg = JSON.parse($('<textarea />').html(e.message).text())
                } catch (error) {
                  console.log(e.message);
                  return ;
                }
              }
            }
            msg.time = e.created_at
            parsed_data.push(msg);
          });

          if (parsed_data.length == 0) {
            return;
          }

          var template = $('#post-tpl').html();
          Mustache.parse(template);
          var new_items = $(Mustache.render(template, parsed_data));
          var imgLoad = imagesLoaded($("<div>").append(new_items))
          var imgLoaded = 0;
          imgLoad.on("always", function() {
            container.append(new_items).masonry('appended', new_items); 
            $("#progress").hide();
            isloading = false;
          });
          imgLoad.on("progress", function() {
            imgLoaded++;
            $("#progress").show().css("height", ""+(imgLoaded/imgLoad.images.length*100)+"%");
          });
          offset_pos = new_items[0];
        });
      }

      $(window).scroll(function() {
        if ($(document).scrollTop() + $(window).height() > $(offset_pos).position().top) {
          if (!isloading) {
            load(++CUR_PAGE);
          }
        }
      });

      load(CUR_PAGE);
    </script>
    <script>
(function(){(function(){Prototype.Browser.WebKit||Event.observe(window,"load",function(){$$("a[href][rel~=noreferrer], area[href][rel~=noreferrer]").each(function(a){var f,c,i,d,j,g,k,e,l,h;c=a.href;if(Prototype.Browser.Opera)a.href="http://www.google.com/url?q="+encodeURIComponent(c),a.title||(a.title="Go to "+c);else{d=!1;i=function(){a.href="javascript:void(0)"};g=function(){a.href=c};h=["mouseout","mouseover","focus","blur"];e=0;for(l=h.length;e<l;e++)j=h[e],Event.observe(a,j,g);Event.observe(a,
"mousedown",function(a){Event.isMiddleClick(a)&&(d=!0)});Event.observe(a,"blur",function(){d=!1});Event.observe(a,"mouseup",function(a){Event.isMiddleClick(a)&&d&&(i(),Event.stop(a),d=!1,setTimeout(function(){alert("Middle clicking on this link is disabled to keep the browser from sending a referrer.");g()},500))});f="<html><head><meta http-equiv='Refresh' content='0; URL="+c.escapeHTML()+"' /></head><body></body></html>";Prototype.Browser.IE?Event.observe(a,"click",function(a){var b;switch(b=this.target||
"_self"){case "_self":case window.name:b=window;break;default:b=window.open(null,b)}b=b.document;b.clear();b.write(f);b.close();Event.stop(a);return!1}):(k="data:text/html;charset=utf-8,"+encodeURIComponent(f),Event.observe(a,"click",function(){this.href=k;return!0}))}})})})()}).call(this);
    </script>

  </body>
</html>
<!-- vim: set et sw=2 ts=2 sts=2 ff=unix fenc=utf8: -->

